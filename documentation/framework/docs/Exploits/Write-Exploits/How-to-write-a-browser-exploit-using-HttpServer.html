<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>How to write a browser exploit using HTTP Server</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../../styles.css" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,400;0,700;1,300;1,400&display=swap" />
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  <nav class="right">
    <ul>
      <li style="display: inline;"> <a href="https://github.com/rapid7/metasploit-framework/tree/master/documentation/modules" target="_blank">Module Docs</a></li>
      <li style="display: inline;"><a href="https://rapid7.github.io/metasploit-framework/api/" target="_blank">API</a></li>
      <li style="display: inline;"><a href="https://github.com/rapid7/metasploit-framework" target="_blank">Metasploit GitHub</a></li>
    </ul>
  </nav>
</head>
<body>

<div id="main-outer-box">

<div id="my-header">
  <a href="../../index.html">Metasploit Framework</a>
</div>

<div id="trunk-box">

<div id="nav-box">
<p>Contents:</p>
<ul>
<li>Getting-Started/
<ul>
<li><a href="../.././Getting-Started/setting-up-metasploit-dev-enviroment.html">Setting up a Metasploit Developer Environment</a></li>
<li>Contributing/
<ul>
<li><a href="../.././Getting-Started/Contributing/Code-Of-Conduct.html">Contributor Code of Conduct</a></li>
<li><a href="../.././Getting-Started/Contributing/Contributing-to-Metasploit.html">Contributing to Metasploit</a></li>
<li><a href="../.././Getting-Started/Contributing/Guidelines-for-Accepting-Modules-and-Enhancements.html">Guidelines for accepting modules and enhancements</a></li>
<li><a href="../.././Getting-Started/Contributing/Adding-Release-Notes-to-PRs.html">Adding release notes to PRs</a></li>
<li><a href="../.././Getting-Started/Contributing/Landing-Pull-Requests.html">Landing pull requests</a></li>
<li><a href="../.././Getting-Started/Contributing/Keeping-in-sync-with-rapid7-master.html">Keep in sync with master</a></li>
<li><a href="../.././Getting-Started/Contributing/How-to-add-and-update-gems-in-metasploit-framework.html">How to add and update gems</a></li>
<li><a href="../.././Getting-Started/Contributing/How-to-deprecate-a-Metasploit-module.html">How to deprecate a Metasploit module</a></li>
<li><a href="../.././Getting-Started/Contributing/Rolling-back-merges.html">Roll back merges</a></li>
<li><a href="../.././Getting-Started/Contributing/Style-Tips.html">Style Tips</a></li>
<li><a href="../.././Getting-Started/Contributing/Reporting-a-Bug.html">Metasploit Bug Reporting</a></li>
<li><a href="../.././Getting-Started/Contributing/markdown-cheat-sheet.html">Markdown Cheat Sheet</a></li>
</ul></li>
<li>Kali-Linux/
<ul>
<li><a href="../.././Getting-Started/Kali-Linux/How-to-get-Oracle-Support-working-with-Kali-Linux.html">Use Oracle support with Kali Linux</a></li>
</ul></li>
<li><a href="../.././Getting-Started/Contact.html">Contact</a></li>
</ul></li>
<li>Modules/
<ul>
<li><a href="../.././Modules/How-to-use-a-Metasploit-module-appropriately.html">Properly use a module</a></li>
<li><a href="../.././Modules/Module-Documentation.html">Module documentation</a></li>
<li><a href="../.././Modules/Module-Reference-Identifiers.html">Reference Identifiers</a></li>
<li><a href="../.././Modules/Handling-Module-Failures-with-fail_with.html">Handing modules failures with <code>fail_with</code></a></li>
<li><a href="../.././Modules/Running-Private-Modules.html">Run private modules</a></li>
<li><a href="../.././Modules/How-to-do-reporting-or-store-data-in-module-development.html">How to do reporting and store data during module development</a></li>
<li><a href="../.././Modules/Using-ReflectiveDll-Injection.html">Using the ReflectiveDll loader in a Metasploit module</a></li>
<li>Write-Modules/
<ul>
<li><a href="../.././Modules/Write-Modules/How-to-write-a-module-using-HttpServer-and-HttpClient.html">How to write a module using HTTPServer and HTTPClient</a></li>
<li><a href="../.././Modules/Write-Modules/Writing-External-Metasploit-Modules.html">Writing External Metasploit Modules</a></li>
<li><a href="../.././Modules/Write-Modules/get-started-writing-auxillary-module.html">Get started with writing an auxiliary module</a></li>
<li><a href="../.././Modules/Write-Modules/How-to-write-a-HTTP-LoginScanner-Module.html">How to write a HTTP LoginScanner Module</a></li>
<li><a href="../.././Modules/Write-Modules/Writing-External-Python-Modules.html">Writing Python Modules for Metasploit</a></li>
<li><a href="../.././Modules/Write-Modules/get-started-writing-post-module.html">Get started with writing a post module</a></li>
<li><a href="../.././Modules/Write-Modules/Writing-External-GoLang-Modules.html">Writing external GoLang modules</a></li>
<li><a href="../.././Modules/Write-Modules/login-scanner.html">Create a Login Scanner Module</a></li>
<li><a href="../.././Modules/Write-Modules/http-login-scanner.html">How to write a HTTP LoginScanner Module</a></li>
</ul></li>
</ul></li>
<li>Exploits/
<ul>
<li><a href="../.././Exploits/Information-About-Unmet-Browser-Exploit-Requirements.html">Unmet browser exploit requirements</a></li>
<li><a href="../.././Exploits/How-to-use-Powershell-in-an-exploit.html">Add PowerShell mixin to an exploit</a></li>
<li><a href="../.././Exploits/How-to-clean-up-files-using-FileDropper.html">How to clean up files using FileDropper</a></li>
<li><a href="../.././Exploits/How-to-use-PhpEXE-to-exploit-an-arbitrary-file-upload-bug.html">PhpEXE arbitrary file upload</a></li>
<li><a href="../.././Exploits/How-to-use-Railgun-for-Windows-post-exploitation.html">Use Railgun for Windows</a></li>
<li><a href="../.././Exploits/How-to-use-command-stagers.html">Use command stagers</a></li>
<li><a href="../.././Exploits/exploit-ranking.html">Exploit Ranking</a></li>
<li>Write-Exploits/
<ul>
<li><a href="writing-exploits.html">Get Started Writing an Exploit</a></li>
<li><a href="How-to-use-WbemExec-for-a-write-privilege-attack-on-Windows.html">Write a privilege attack with WbemExec</a></li>
<li><a href="How-to-Use-the-FILEFORMAT-mixin-to-create-a-file-format-exploit.html">How to use the FILEFORMAT mixin</a></li>
<li><strong>How to write a browser exploit using HTTP Server</strong></li>
<li><a href="How-to-write-a-browser-exploit-using-BrowserExploitServer.html">Write a browser exploit with BrowserExploitServer</a></li>
</ul></li>
</ul></li>
<li>Payloads/
<ul>
<li><a href="../.././Payloads/how-payloads-work.html">How Payloads Work</a></li>
<li><a href="../.././Payloads/payload-debugging.html">Payload Debugging</a></li>
<li><a href="../.././Payloads/Payload-UUID.html">Payload UUID</a></li>
<li>Meterpreter/
<ul>
<li><a href="../.././Payloads/Meterpreter/about-meterpreter.html">About Meterpreter</a></li>
<li><a href="../.././Payloads/Meterpreter/meterpreter-configuration.html">Meterpreter Configuration</a></li>
<li><a href="../.././Payloads/Meterpreter/transport-control.html">Transport Control</a></li>
<li><a href="../.././Payloads/Meterpreter/Meterpreter-Reliable-Network-Communication.html">Reliable Network Communication</a></li>
<li><a href="../.././Payloads/Meterpreter/Meterpreter-Unicode-Support.html">Unicode Support</a></li>
<li><a href="../.././Payloads/Meterpreter/Meterpreter-HTTP-Communication.html">Meterpreter HTTP communication</a></li>
<li><a href="../.././Payloads/Meterpreter/Meterpreter-Sleep-Control.html">Sleep Control</a></li>
<li><a href="../.././Payloads/Meterpreter/Meterpreter-Paranoid-Mode.html">Paranoid Mode</a></li>
<li><a href="../.././Payloads/Meterpreter/The-ins-and-outs-of-HTTP-and-HTTPS-communications-in-Meterpreter-and-Metasploit-Stagers.html">HTTP and HTTPS communication</a></li>
<li><a href="../.././Payloads/Meterpreter/Python-Extension.html">Python Extension</a></li>
</ul></li>
<li>msfvenom/
<ul>
<li><a href="../.././Payloads/msfvenom/How-to-use-msfvenom.html">How to use msfvenom</a></li>
</ul></li>
<li>Shell/
<ul>
<li><a href="../.././Payloads/Shell/How-to-use-a-reverse-shell-in-Metasploit.html">How to use a reverse shell</a></li>
</ul></li>
</ul></li>
<li>Utilities/
<ul>
<li><a href="../.././Utilities/complier-windows-c.html">How to use Metasploit Framework Compiler Windows to compile C code</a></li>
<li><a href="../.././Utilities/oracle-support-kali-linux.html">Oracle Support working with Kali Linux</a></li>
<li><a href="../.././Utilities/How-to-zip-files-with-Msf-Util-EXE.to_zip.html">How to zip files with Msf::Util::EXE.to_zip</a></li>
<li><a href="../.././Utilities/How-to-use-the-Msf-Exploit-Remote-Tcp-mixin.html">How to use the Msf::Exploit::Remote::Tcp mixin</a></li>
</ul></li>
<li>Evasion-and-Obfuscation/
<ul>
<li><a href="../.././Evasion-and-Obfuscation/obfuscation-crandomizer.html">CRandomizer</a></li>
<li><a href="../.././Evasion-and-Obfuscation/How-to-obfuscate-JavaScript-in-Metasploit.html">Obfuscate JavaScript</a></li>
<li><a href="../.././Evasion-and-Obfuscation/How-to-use-Metasploit-Framework-Obfuscation-CRandomizer.html">How to use CRandomizer</a></li>
</ul></li>
<li>API/
<ul>
<li><a href="../.././API/Metasploit-Web-Service.html">Metasploit web service</a></li>
</ul></li>
<li>Debugging/
<ul>
<li><a href="../.././Debugging/How-to-log-in-Metasploit.html">Log Files in Metasploit</a></li>
<li><a href="../.././Debugging/Why-CVE-is-not-available.html">Why is a CVE Not Available?</a></li>
</ul></li>
<li><a href="../.././external-resources.html">External Resources</a></li>
</ul>

</div>

<div id="article-box">

<div id="header-nav-bar">
<div><a href="How-to-Use-the-FILEFORMAT-mixin-to-create-a-file-format-exploit.html">←prev</a></div><div class="nav-bar-push"><a href="How-to-write-a-browser-exploit-using-BrowserExploitServer.html">next→</a></div>
</div>

<div id="article-content">
<header id="title-block-header">
<h1 class="title">How to write a browser exploit using HTTP Server</h1>
</header>
<p>The Metasploit Framework provides different mixins you can use to develop a browser exploit, mainly they are <a href="https://github.com/rapid7/metasploit-framework/wiki/How-to-write-a-browser-exploit-using-HttpServer">Msf::Exploit::Remote::HttpServer</a>, Msf::Exploit::Remote::HttpServer::HTML and <a href="https://github.com/rapid7/metasploit-framework/wiki/How-to-write-a-browser-exploit-using-BrowserExploitServer">Msf::Exploit::Remote::BrowserExploitServer</a>. This writeup covers the HttpServer mixin.</p>
<p>The HttpServer mixin is kind of the mother of all HTTP server mixins (like BrowserExploitServer and HttpServer::HTML). To use it, your module is required to have a “on_request_uri” method, which is a callback triggered when the HTTP server receives a HTTP request from the browser. An example of setting up “on_request_uri”:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode ruby"><code class="sourceCode ruby"><span id="cb1-1"><a href="#cb1-1"></a><span class="co">#</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="co"># Listens for a HTTP request.</span></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="co"># cli is the socket object, and request is a Rex::Proto::Http::Request object</span></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co">#</span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="kw">def</span> on_request_uri(cli, request)</span>
<span id="cb1-6"><a href="#cb1-6"></a>    print_status(<span class="st">&quot;Client requests URI: </span><span class="ot">#{</span>request.uri<span class="ot">}</span><span class="st">&quot;</span>)</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="kw">end</span></span></code></pre></div>
<p>The “on_request_uri” method is also where you can create the HTTP response. Here’s a couple of choices you can use to do that:</p>
<ul>
<li><strong>send_not_found(cli)</strong> - Sends a 404 to the client. Make sure to pass the cli (socket) object.</li>
<li><strong>send_redirect(cli, location=‘/’, body=’’, headers={})</strong> - Redirects the client to a new location.</li>
<li><strong>send_response(cli, body, headers={})</strong> - Sends a response to the client. This method is probably what you’ll be using most of the time.</li>
</ul>
<p>If you’ve seen some of our exploit modules, you will also see them using Exploit::Remote::HttpServer::HTML instead of Exploit::Remote::HttpServer. Usage is mostly the same, the difference is the Exploit::Remote::HttpServer::HTML mixin gives you access to some Javascript functions like Base64, heap spraying, OS detection, etc.</p>
<p>Here’s an example of sending a HTTP response:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode ruby"><code class="sourceCode ruby"><span id="cb2-1"><a href="#cb2-1"></a><span class="co">#</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="co"># Sends a &quot;Hello, world!&quot; to the client</span></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="co">#</span></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="kw">def</span> on_request_uri(cli, request)</span>
<span id="cb2-5"><a href="#cb2-5"></a>    html = <span class="st">&quot;Hello, world!&quot;</span></span>
<span id="cb2-6"><a href="#cb2-6"></a>    send_response(cli, html)</span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="kw">end</span></span></code></pre></div>
<p>Also note that in order to handle a HTTP request, it must contain the base URIPATH, which by default is random. This means if you want to handle multiple URIs (possible if you need to handle a redirect or a link), you also need to make sure they have the base URIPATH. To retrieve the base URIPATH, you can use the “get_resource” method, here’s an example:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode ruby"><code class="sourceCode ruby"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw">def</span> serve_page_1(cli)</span>
<span id="cb3-2"><a href="#cb3-2"></a>    html = <span class="st">&quot;This is page 1&quot;</span></span>
<span id="cb3-3"><a href="#cb3-3"></a>    send_response(cli, html)</span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="kw">end</span></span>
<span id="cb3-5"><a href="#cb3-5"></a></span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="kw">def</span> serve_page_2(cli)</span>
<span id="cb3-7"><a href="#cb3-7"></a>    html = <span class="st">&quot;This is page 2&quot;</span></span>
<span id="cb3-8"><a href="#cb3-8"></a>    send_response(cli, html)</span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="kw">end</span></span>
<span id="cb3-10"><a href="#cb3-10"></a></span>
<span id="cb3-11"><a href="#cb3-11"></a><span class="kw">def</span> serve_default_page(cli)</span>
<span id="cb3-12"><a href="#cb3-12"></a>    html =<span class="ot"> %Q|</span></span>
<span id="cb3-13"><a href="#cb3-13"></a><span class="ot">    </span>&lt;html&gt;</span>
<span id="cb3-14"><a href="#cb3-14"></a>    &lt;a href=<span class="st">&quot;</span><span class="ot">#{</span>get_resource.chomp(<span class="ch">&#39;/&#39;</span>)<span class="ot">}</span><span class="st">/page_1.html&quot;</span>&gt;<span class="dt">Go</span> to page <span class="dv">1</span>&lt;<span class="ot">/a&gt;&lt;br&gt;</span></span>
<span id="cb3-15"><a href="#cb3-15"></a><span class="ot">    &lt;a href=&quot;#{</span>get_resource.chomp(<span class="ch">&#39;/&#39;</span>)<span class="ot">}/</span>page_2.html<span class="st">&quot;&gt;Go to page 2&lt;/a&gt;</span></span>
<span id="cb3-16"><a href="#cb3-16"></a><span class="st">    &lt;/html&gt;</span></span>
<span id="cb3-17"><a href="#cb3-17"></a><span class="st">    |</span></span>
<span id="cb3-18"><a href="#cb3-18"></a></span>
<span id="cb3-19"><a href="#cb3-19"></a><span class="st">    send_response(cli, html)</span></span>
<span id="cb3-20"><a href="#cb3-20"></a><span class="st">end</span></span>
<span id="cb3-21"><a href="#cb3-21"></a></span>
<span id="cb3-22"><a href="#cb3-22"></a><span class="st">def on_request_uri(cli, request)</span></span>
<span id="cb3-23"><a href="#cb3-23"></a><span class="st">    case request.uri</span></span>
<span id="cb3-24"><a href="#cb3-24"></a><span class="st">    when /page_1\.html$/</span></span>
<span id="cb3-25"><a href="#cb3-25"></a><span class="st">        serve_page_1(cli)</span></span>
<span id="cb3-26"><a href="#cb3-26"></a><span class="st">    when /page_2\.html$/</span></span>
<span id="cb3-27"><a href="#cb3-27"></a><span class="st">        serve_page_2(cli)</span></span>
<span id="cb3-28"><a href="#cb3-28"></a><span class="st">    else</span></span>
<span id="cb3-29"><a href="#cb3-29"></a><span class="st">        serve_default_page(cli)</span></span>
<span id="cb3-30"><a href="#cb3-30"></a><span class="st">    end</span></span>
<span id="cb3-31"><a href="#cb3-31"></a><span class="st">end</span></span></code></pre></div>
<p>Of course, when you write a Metasploit browser exploit there’s a lot more you need to think about. For example, your module probably needs to do browser detection, because it wouldn’t make any sense to allow Chrome to receive an IE exploit, would it? You probably also need to build a payload that’s specific to the target, which means your module needs to know what target it’s hitting, and you have to build a method to customize the exploit accordingly, etc. The HttpServer and HttpServer::HTML mixin provies all kinds of methods to allow you to accomplish all these. Make sure to check out the API documentation (you can either do this by running msf/documentation/gendocs.sh, or just run “yard” in the msf directory), or checkout existing code examples (especially the recent ones).</p>
<p>To get things started, you can always use the following template to start developing your browser exploit:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode ruby"><code class="sourceCode ruby"><span id="cb4-1"><a href="#cb4-1"></a><span class="co">##</span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="co"># This module requires Metasploit: http://metasploit.com/download</span></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="co"># Current source: https://github.com/rapid7/metasploit-framework</span></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="co">##</span></span>
<span id="cb4-5"><a href="#cb4-5"></a></span>
<span id="cb4-6"><a href="#cb4-6"></a>require <span class="st">&#39;msf/core&#39;</span></span>
<span id="cb4-7"><a href="#cb4-7"></a></span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="kw">class</span> <span class="dt">MetasploitModule</span> &lt; <span class="dt">Msf</span>::<span class="dt">Exploit</span>::<span class="dt">Remote</span></span>
<span id="cb4-9"><a href="#cb4-9"></a>  <span class="dt">Rank</span> = <span class="dt">NormalRanking</span></span>
<span id="cb4-10"><a href="#cb4-10"></a></span>
<span id="cb4-11"><a href="#cb4-11"></a>  include <span class="dt">Msf</span>::<span class="dt">Exploit</span>::<span class="dt">Remote</span>::<span class="dt">HttpServer</span></span>
<span id="cb4-12"><a href="#cb4-12"></a></span>
<span id="cb4-13"><a href="#cb4-13"></a>  <span class="kw">def</span> initialize(info={})</span>
<span id="cb4-14"><a href="#cb4-14"></a>    <span class="dv">super</span>(update_info(info,</span>
<span id="cb4-15"><a href="#cb4-15"></a>      <span class="st">&#39;Name&#39;</span>           =&gt; <span class="st">&quot;HttpServer mixin example&quot;</span>,</span>
<span id="cb4-16"><a href="#cb4-16"></a>      <span class="st">&#39;Description&#39;</span>    =&gt;<span class="ot"> %q{</span></span>
<span id="cb4-17"><a href="#cb4-17"></a><span class="st">        Here&#39;s an example of using the HttpServer mixin</span></span>
<span id="cb4-18"><a href="#cb4-18"></a><span class="st">      </span><span class="ot">}</span>,</span>
<span id="cb4-19"><a href="#cb4-19"></a>      <span class="st">&#39;License&#39;</span>        =&gt; <span class="dt">MSF_LICENSE</span>,</span>
<span id="cb4-20"><a href="#cb4-20"></a>      <span class="st">&#39;Author&#39;</span>         =&gt; [ <span class="st">&#39;sinn3r&#39;</span> ],</span>
<span id="cb4-21"><a href="#cb4-21"></a>      <span class="st">&#39;References&#39;</span>     =&gt; </span>
<span id="cb4-22"><a href="#cb4-22"></a>        [</span>
<span id="cb4-23"><a href="#cb4-23"></a>          [ <span class="st">&#39;URL&#39;</span>, <span class="st">&#39;http://metasploit.com&#39;</span> ]</span>
<span id="cb4-24"><a href="#cb4-24"></a>        ],</span>
<span id="cb4-25"><a href="#cb4-25"></a>      <span class="st">&#39;Platform&#39;</span>       =&gt; <span class="st">&#39;win&#39;</span>,</span>
<span id="cb4-26"><a href="#cb4-26"></a>      <span class="st">&#39;Targets&#39;</span>        =&gt;</span>
<span id="cb4-27"><a href="#cb4-27"></a>        [</span>
<span id="cb4-28"><a href="#cb4-28"></a>          [ <span class="st">&#39;Generic&#39;</span>, {} ],</span>
<span id="cb4-29"><a href="#cb4-29"></a>        ],</span>
<span id="cb4-30"><a href="#cb4-30"></a>      <span class="st">&#39;DisclosureDate&#39;</span> =&gt; <span class="st">&quot;Apr 1 2013&quot;</span>,</span>
<span id="cb4-31"><a href="#cb4-31"></a>      <span class="st">&#39;DefaultTarget&#39;</span>  =&gt; <span class="dv">0</span>))</span>
<span id="cb4-32"><a href="#cb4-32"></a>  <span class="kw">end</span></span>
<span id="cb4-33"><a href="#cb4-33"></a></span>
<span id="cb4-34"><a href="#cb4-34"></a>  <span class="kw">def</span> on_request_uri(cli, request)</span>
<span id="cb4-35"><a href="#cb4-35"></a>    html = <span class="st">&quot;hello&quot;</span></span>
<span id="cb4-36"><a href="#cb4-36"></a>    send_response(cli, html)</span>
<span id="cb4-37"><a href="#cb4-37"></a>  <span class="kw">end</span></span>
<span id="cb4-38"><a href="#cb4-38"></a></span>
<span id="cb4-39"><a href="#cb4-39"></a><span class="kw">end</span></span></code></pre></div>
<p>If you want to take a closer look at what the mixin can do, see: https://github.com/rapid7/metasploit-framework/blob/master/lib/msf/core/exploit/http/server.rb</p>

</div> <!-- article-content -->

<div id="footer-nav-bar">
<div><a href="How-to-Use-the-FILEFORMAT-mixin-to-create-a-file-format-exploit.html">←prev</a></div><div class="nav-bar-push"><a href="How-to-write-a-browser-exploit-using-BrowserExploitServer.html">next→</a></div>
</div>

</div> <!-- article-box -->

</div> <!-- trunk-box -->

<div id="my-footer">
<p>Copyright <a href="https://metasploit.com/">Metasploit</a>, 2020</p>
<p><a href="https://join.slack.com/t/metasploit/shared_invite/enQtOTMxMjg5ODY3NDYxLTYyZTVlNDM1ZTI3ZGQ0YTQ0NmI1YjgxMGEwYzFhOWNiZWQ4NDNmNTE1MWNiYzJhMzgwMGY0ZWY2NTY0MjA2M2I">Slack team - metasploit.slack.com</a></p>
<p><a href="https://twitter.com/metasploit">#twitter handle - @metasploit</a></p>
<p><a href="mailto:msfdev@metasploit.com">development questions - msfdev [ @ ] metasploit.com</a></p><br/>
<a href="How-to-write-a-browser-exploit-using-HttpServer.md">Pandoc-Markdown source for this page</a><br/>
(Docs processed by
<a href="http://www.unexpected-vortices.com/sw/rippledoc/index.html">Rippledoc</a>.)
</div> <!-- my-footer -->

</div> <!-- main-outer-box -->

</body>
</html>
