<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Use exploits</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../styles.css" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,400;0,700;1,300;1,400&display=swap" />
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>

<div id="main-outer-box">

<nav class="right">
  <ul>
    <li style="display: inline;"> <a href="https://github.com/rapid7/metasploit-framework/tree/master/documentation/modules" target="_blank">Module Docs</a></li>
    <li style="display: inline;"><a href="https://rapid7.github.io/metasploit-framework/api/" target="_blank">API</a></li>
    <li style="display: inline;"><a href="https://github.com/rapid7/metasploit-framework" target="_blank">Metasploit GitHub</a></li>
     <li style="display: inline;"><a href="../search.html">Search</a></li>
  </ul>
</nav>

<div id="my-header">
  <a href="{{path-to-index}}">Metasploit Framework</a>
</div>

<div id="trunk-box">

<div id="nav-box">
<p>Contents:</p>
<ul>
<li>Getting-Started/
<ul>
<li><a href=".././Getting-Started/Installing-Metasploit.html">Installing Metasploit</a></li>
<li><a href=".././Getting-Started/setting-up-metasploit-dev-enviroment.html">Setting up a Metasploit Developer Environment</a></li>
<li>Contributing/
<ul>
<li><a href=".././Getting-Started/Contributing/Code-Of-Conduct.html">Contributor Code of Conduct</a></li>
<li><a href=".././Getting-Started/Contributing/Contributing-to-Metasploit.html">Contributing to Metasploit</a></li>
<li><a href=".././Getting-Started/Contributing/Guidelines-for-Accepting-Modules-and-Enhancements.html">Guidelines for accepting modules and enhancements</a></li>
<li><a href=".././Getting-Started/Contributing/Adding-Release-Notes-to-PRs.html">Adding release notes to PRs</a></li>
<li><a href=".././Getting-Started/Contributing/Landing-Pull-Requests.html">Landing pull requests</a></li>
<li><a href=".././Getting-Started/Contributing/Keeping-in-sync-with-rapid7-master.html">Keep in sync with master</a></li>
<li><a href=".././Getting-Started/Contributing/How-to-add-and-update-gems-in-metasploit-framework.html">How to add and update gems</a></li>
<li><a href=".././Getting-Started/Contributing/How-to-deprecate-a-Metasploit-module.html">How to deprecate a Metasploit module</a></li>
<li><a href=".././Getting-Started/Contributing/Rolling-back-merges.html">Roll back merges</a></li>
<li><a href=".././Getting-Started/Contributing/Style-Tips.html">Style Tips</a></li>
<li><a href=".././Getting-Started/Contributing/Reporting-a-Bug.html">Metasploit Bug Reporting</a></li>
<li><a href=".././Getting-Started/Contributing/markdown-cheat-sheet.html">Markdown Cheat Sheet</a></li>
</ul></li>
<li>Kali-Linux/
<ul>
<li><a href=".././Getting-Started/Kali-Linux/How-to-get-Oracle-Support-working-with-Kali-Linux.html">Use Oracle support with Kali Linux</a></li>
</ul></li>
<li><a href=".././Getting-Started/Contact.html">Contact</a></li>
</ul></li>
<li>Internals/
<ul>
<li><a href=".././Internals/workspaces.html">Workspaces</a></li>
</ul></li>
<li>Modules/
<ul>
<li><a href=".././Modules/How-to-use-a-Metasploit-module-appropriately.html">Properly use a module</a></li>
<li><a href=".././Modules/Module-Documentation.html">Module documentation</a></li>
<li><a href=".././Modules/Handling-Module-Failures-with-fail_with.html">Handing modules failures with <code>fail_with</code></a></li>
<li><a href=".././Modules/Running-Private-Modules.html">Run private modules</a></li>
<li><a href=".././Modules/How-to-do-reporting-or-store-data-in-module-development.html">How to do reporting and store data during module development</a></li>
<li><a href=".././Modules/Using-ReflectiveDll-Injection.html">Using the ReflectiveDll loader in a Metasploit module</a></li>
<li>Write-Modules/
<ul>
<li><a href=".././Modules/Write-Modules/How-to-write-a-module-using-HttpServer-and-HttpClient.html">How to write a module using HTTPServer and HTTPClient</a></li>
<li><a href=".././Modules/Write-Modules/Writing-External-Metasploit-Modules.html">Writing External Metasploit Modules</a></li>
<li><a href=".././Modules/Write-Modules/get-started-writing-auxillary-module.html">Get started with writing an auxiliary module</a></li>
<li><a href=".././Modules/Write-Modules/How-to-write-a-HTTP-LoginScanner-Module.html">How to write a HTTP LoginScanner Module</a></li>
<li><a href=".././Modules/Write-Modules/Writing-External-Python-Modules.html">Writing Python Modules for Metasploit</a></li>
<li><a href=".././Modules/Write-Modules/get-started-writing-post-module.html">Get started with writing a post module</a></li>
<li><a href=".././Modules/Write-Modules/Writing-External-GoLang-Modules.html">Writing external GoLang modules</a></li>
<li><a href=".././Modules/Write-Modules/login-scanner.html">Create a Login Scanner Module</a></li>
<li><a href=".././Modules/Write-Modules/http-login-scanner.html">How to write a HTTP LoginScanner Module</a></li>
</ul></li>
<li><a href=".././Modules/module-reference-identifiers.html">Reference Identifiers</a></li>
</ul></li>
<li>Exploits/
<ul>
<li><strong>Use exploits</strong></li>
<li><a href="Information-About-Unmet-Browser-Exploit-Requirements.html">Unmet browser exploit requirements</a></li>
<li><a href="How-to-use-Powershell-in-an-exploit.html">Add PowerShell mixin to an exploit</a></li>
<li><a href="How-to-clean-up-files-using-FileDropper.html">How to clean up files using FileDropper</a></li>
<li><a href="How-to-use-PhpEXE-to-exploit-an-arbitrary-file-upload-bug.html">PhpEXE arbitrary file upload</a></li>
<li><a href="How-to-use-Railgun-for-Windows-post-exploitation.html">Use Railgun for Windows</a></li>
<li><a href="How-to-use-command-stagers.html">Use command stagers</a></li>
<li><a href="exploit-ranking.html">Exploit Ranking</a></li>
<li>Write-Exploits/
<ul>
<li><a href=".././Exploits/Write-Exploits/writing-exploits.html">Get Started Writing an Exploit</a></li>
<li><a href=".././Exploits/Write-Exploits/How-to-use-WbemExec-for-a-write-privilege-attack-on-Windows.html">Write a privilege attack with WbemExec</a></li>
<li><a href=".././Exploits/Write-Exploits/How-to-Use-the-FILEFORMAT-mixin-to-create-a-file-format-exploit.html">How to use the FILEFORMAT mixin</a></li>
<li><a href=".././Exploits/Write-Exploits/How-to-write-a-browser-exploit-using-HttpServer.html">How to write a browser exploit using HTTP Server</a></li>
<li><a href=".././Exploits/Write-Exploits/How-to-write-a-browser-exploit-using-BrowserExploitServer.html">Write a browser exploit with BrowserExploitServer</a></li>
</ul></li>
</ul></li>
<li>Payloads/
<ul>
<li><a href=".././Payloads/how-payloads-work.html">How Payloads Work</a></li>
<li><a href=".././Payloads/payload-debugging.html">Payload Debugging</a></li>
<li><a href=".././Payloads/Payload-UUID.html">Payload UUID</a></li>
<li>Meterpreter/
<ul>
<li><a href=".././Payloads/Meterpreter/about-meterpreter.html">About Meterpreter</a></li>
<li><a href=".././Payloads/Meterpreter/meterpreter-configuration.html">Meterpreter Configuration</a></li>
<li><a href=".././Payloads/Meterpreter/transport-control.html">Transport Control</a></li>
<li><a href=".././Payloads/Meterpreter/Meterpreter-Reliable-Network-Communication.html">Reliable Network Communication</a></li>
<li><a href=".././Payloads/Meterpreter/Meterpreter-Unicode-Support.html">Unicode Support</a></li>
<li><a href=".././Payloads/Meterpreter/Meterpreter-HTTP-Communication.html">Meterpreter HTTP communication</a></li>
<li><a href=".././Payloads/Meterpreter/Meterpreter-Sleep-Control.html">Sleep Control</a></li>
<li><a href=".././Payloads/Meterpreter/Meterpreter-Paranoid-Mode.html">Paranoid Mode</a></li>
<li><a href=".././Payloads/Meterpreter/The-ins-and-outs-of-HTTP-and-HTTPS-communications-in-Meterpreter-and-Metasploit-Stagers.html">HTTP and HTTPS communication</a></li>
<li><a href=".././Payloads/Meterpreter/Python-Extension.html">Python Extension</a></li>
</ul></li>
<li>msfvenom/
<ul>
<li><a href=".././Payloads/msfvenom/How-to-use-msfvenom.html">How to use msfvenom</a></li>
</ul></li>
<li>Shell/
<ul>
<li><a href=".././Payloads/Shell/How-to-use-a-reverse-shell-in-Metasploit.html">How to use a reverse shell</a></li>
</ul></li>
</ul></li>
<li>Utilities/
<ul>
<li><a href=".././Utilities/complier-windows-c.html">How to use Metasploit Framework Compiler Windows to compile C code</a></li>
<li><a href=".././Utilities/oracle-support-kali-linux.html">Oracle Support working with Kali Linux</a></li>
<li><a href=".././Utilities/How-to-zip-files-with-Msf-Util-EXE.to_zip.html">How to zip files with Msf::Util::EXE.to_zip</a></li>
<li><a href=".././Utilities/How-to-use-the-Msf-Exploit-Remote-Tcp-mixin.html">How to use the Msf::Exploit::Remote::Tcp mixin</a></li>
</ul></li>
<li>Evasion-and-Obfuscation/
<ul>
<li><a href=".././Evasion-and-Obfuscation/obfuscation-crandomizer.html">CRandomizer</a></li>
<li><a href=".././Evasion-and-Obfuscation/How-to-obfuscate-JavaScript-in-Metasploit.html">Obfuscate JavaScript</a></li>
<li><a href=".././Evasion-and-Obfuscation/How-to-use-Metasploit-Framework-Obfuscation-CRandomizer.html">How to use CRandomizer</a></li>
</ul></li>
<li>API/
<ul>
<li><a href=".././API/Metasploit-Web-Service.html">Metasploit web service</a></li>
<li><a href=".././API/Metasploit-as-a-service.html">Metasploit as a service</a></li>
</ul></li>
<li>Debugging/
<ul>
<li><a href=".././Debugging/How-to-log-in-Metasploit.html">Log Files in Metasploit</a></li>
<li><a href=".././Debugging/Why-CVE-is-not-available.html">Why is a CVE Not Available?</a></li>
</ul></li>
<li><a href=".././external-resources.html">Community Resources</a></li>
</ul>

</div>

<div id="article-box">

<div id="header-nav-bar">
<div><a href=".././Modules/module-reference-identifiers.html">←prev</a></div><div class="nav-bar-push"><a href="Information-About-Unmet-Browser-Exploit-Requirements.html">next→</a></div>
</div>

<div id="article-content">
<header id="title-block-header">
<h1 class="title">Use exploits</h1>
</header>
<nav id="TOC" role="doc-toc">
<ul>
<li><a href="#limitations-of-an-exploit">Limitations of an exploit</a></li>
<li><a href="#exploitable-requirements">Exploitable requirements</a></li>
<li><a href="#corruption-reliability">Corruption reliability</a></li>
<li><a href="#payload-support">Payload support</a></li>
<li><a href="#post-exploitation-support">Post exploitation support</a></li>
<li><a href="#the-exploit-tree">The exploit tree</a></li>
<li><a href="#choosing-an-exploit">Choosing an exploit</a></li>
</ul>
</nav>
<p>Exploits are programs that take advantage of software flaws (vulnerabilities) to achieve unintended results such as arbitrary code execution, privilege escalation, denial-of-service, information disclosure, etc. However, the definition of an exploit is much more strict with Metasploit: it’s a Ruby script that gives you a shell.</p>
<p>To load an exploit type “use” in the terminal. For example:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1"></a><span class="ex">msf</span> <span class="op">&gt;</span> use exploit/windows/smb/ms08_067_netapi</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="ex">msf</span> <span class="op">&gt;</span> exploit(ms08_067_netapi) <span class="op">&gt;</span></span></code></pre></div>
<p>After an exploit is loaded, you also need to set all the required options. To find out what options are required, you can use the <code>show missing</code> command. And then you can use either the <code>run</code> or <code>exploit</code> command to start the exploit.</p>
<h2 id="limitations-of-an-exploit">Limitations of an exploit</h2>
<p>Unlike regular programs, most exploits are application-specific (requirements), and they probably have side-effects on the target machine (for example: DOSing the service or even the machine). It would help if you thought about that before hitting the exploit against a real target.</p>
<blockquote>
<p>Get Metasploitable3 <a href="https://github.com/rapid7/metasploitable3">https://github.com/rapid7/metasploitable3</a></p>
</blockquote>
<h2 id="exploitable-requirements">Exploitable requirements</h2>
<p>One primary type of requirement is that <strong>most exploits are version-specific</strong>. As a software developer, sometimes we create new bugs or vulnerabilities when new features are released, or when new patches are applied, and your exploit will only work if the buggy code actually exists (and reachable). Take <code>ms14_012_textrange</code> for example, this is an exploit for Internet Explorer 9, but it only works against IE9s that were built between July 2013 to February 2014. So if you were to use this exploit, you would have to know the exact MSHTML build your target is using. Luckily, the ms14_012 module is capable of checking this automatically.</p>
<p>The <code>check</code> command can help to determine if your targets are vulnerable, or no. Not all modules support the check command, but for the ones that do, you can tell it to check for a range of hosts:</p>
<p><img src="../assets/check_command.png" class="center" style="width:500px;" alt="Metasploit check command output"></p>
<p>If something is being flagged as vulnerable, it means the check function triggered the buggy code and picked up the vulnerable symptoms. If the check says “Appears,” then it just means the target looks vulnerable through passive surveillance. “Cannot reliably check exploitability” basically means the module thinks the target is safe from exploitation.</p>
<p>Another type of requirement to understand is <strong>vulnerability does not always equal to exploitability</strong>, especially if the exploit depends on other environmental factors to achieve code execution. Years ago, if you found a memory corruption on SMB such as <code>ms08_067_netapi</code>, you would be able to exploit it because Windows had fewer mitigations. But today, if you find something similar on Windows 8, you will hit all kinds of memory protections such as GS, DEP, ASLR, SEH, SEHOP, more memory randomness. It’s challenging.</p>
<p>Other common exploitable requirements include:</p>
<ul>
<li>The use of a 3rd party DLL to bypass default mitigations</li>
<li>The use of specific Windows APIs</li>
<li>Appropriate permissions, such as on the file system and the application, etc. An example of this is abusing the PUT method in HTTP.</li>
<li>Post-authentication: If you can’t figure out the password to trigger the vulnerable code, you’re not exploiting anything, are you?</li>
</ul>
<p>The worst case that can happen for not meeting the exploitable requirements is crashing the target machine or causing permanent damage (bad data being stored).</p>
<p>Ideally, all this required information should be explained in the exploit’s metadata, which can be retrieved with the <code>info</code> command in msfconsole. If this isn’t well documented in the module, then you can try these approaches:</p>
<ul>
<li><a href="https://github.com/rapid7/metasploit-framework/pulls?q=is%3Apr+is%3Aclosed">Github</a>: Before a Metasploit module is published, it goes through testing and code review as a <a href="http://lmgtfy.com/?q=what+is+a+pull+request">pull request</a>. Usually, this pull request documents setup requirements, vulnerability information, steps to test, limitations, real user feedback, etc.</li>
<li>The <code>info</code> command also shows the Metasploit author’s name and maybe the contact information. You can try asking.</li>
<li>Try it yourself against your own test machine.</li>
</ul>
<h2 id="corruption-reliability">Corruption reliability</h2>
<p>One of the most common types of vulnerabilities is memory corruption, so it’s worth learning about what it does for you. Memory corruptions are corrupt data in memory, in most cases, they result in crashes, but it’s also possible they can be so subtle you don’t even know it’s happening. We’ll focus on crashes because it’s easier to explain.</p>
<p>When an exploit is taking advantage of a memory corruption, what that means is it’s controlling that crash. When you’re able to control that crash, you’re controlling code execution. And of course, when you’re controlling code execution, you do whatever you want.</p>
<p>However, a crash is still a crash after all, so there are risks. Some exploits can control the crash extremely well and consistently get you a shell, some are always somewhat unstable at different stages due to various reasons. When you’re using an exploit, you need to keep this in mind.</p>
<p>The easiest way to find out about a Metasploit exploit’s reliability is from the ranking, and you can use the <code>info</code> command to find it. There are currently <a href="exploit-ranking.html">seven different rankings</a> used by modules. Sometimes the exploit’s reliability is also mentioned in the module description.</p>
<h2 id="payload-support">Payload support</h2>
<p>Metasploit has a huge selection of payloads, but it’s up for the exploit to decide which ones are actually supported. To find out, after you choose an exploit, you can use the “show payloads” command to list all available payloads.</p>
<p>Meterpreter is the most popular type of payload for Metasploit. Practically speaking, if you are testing a Windows exploit, it’s better to use windows/meterpreter/reverse_tcp. If you’re on Linux, try <code>linux/meterpreter/reverse_tcp</code>. Always choose a native meterpreter first if you can, if not, if there’s a cross-platform one (such as <code>java/meterpreter/reverse_tcp</code>), then try that.</p>
<p>To manually select a payload for you exploit, here’s what you do:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">set</span> <span class="ex">payload</span> windows/meterpreter/reverse_tcp</span></code></pre></div>
<p>If you’re feeling lazy, you don’t actually always have to manually select a payload. Msfconsole actually has its own preference list in the following order if nothing is selected by the user:</p>
<ol type="1">
<li>windows/meterpreter/reverse_tcp</li>
<li>java/meterpreter/reverse_tcp</li>
<li>php/meterpreter/reverse_tcp</li>
<li>php/meterpreter_reverse_tcp</li>
<li>ruby/shell_reverse_tcp</li>
<li>cmd/unix/interact</li>
<li>cmd/unix/reverse</li>
<li>cmd/unix/reverse_perl</li>
<li>cmd/unix/reverse_netcat_gaping</li>
<li>windows/meterpreter/reverse_nonx_tcp</li>
<li>windows/meterpreter/reverse_ord_tcp</li>
<li>windows/shell/reverse_tcp</li>
<li>generic/shell_reverse_tcp</li>
</ol>
<h2 id="post-exploitation-support">Post exploitation support</h2>
<p>When an exploit successfully gives you a shell, you are under the context of the process you’re exploiting. Do I mean “under the context of the user?” Well, it used to be yes, but against modern systems, this may be more like a yes and no. Why is that?</p>
<p>When you get a shell, yes, you are under the context of the user. But depending on what process you’re exploiting, there may be more access control so you actually get less privileges to resources compare to the actual user. One example of this is <a href="https://docs.microsoft.com/en-us/archive/blogs/ie/enhanced-protected-mode">Internet Explorer’s Enhanced Protected Mode</a>. In that case, you will have to find another exploit to escalate your privileges.</p>
<p>Privilege escalation is considered a type of post-exploitation (but not as post modules). In Metasploit, whatever post-exploitation type modules you can use depend on what type of session you’re on. There is either a <strong>meterpreter type session</strong>, or a <strong>shell session</strong>, and Meterpreter has always been favored much more than Shell.</p>
<p>If you are stuck with a shell session, you can use the <code>post/multi/manage/shell_to_meterpreter</code> module to upgrade your shell to a meterpreter.</p>
<h2 id="the-exploit-tree">The exploit tree</h2>
<p>At this point, hopefully, you have learned everything I want you to know about exploits’ capabilities in general: from exploitable requirements, reliability, payload support, and post-exploitation support.</p>
<p>From here, we’ll talk about choosing an exploit. From browsing the exploit tree, to actually picking the most appropriate one. All exploits in Metasploit are placed under the “modules/exploits” directory, and roughly are organized this way (each box represents a directory):</p>
<p><img src="../assets/exploit-tree.png" class="center" style="width:500px;" alt="Metasploit check command output"></p>
<p>So let’s say you want to pick an exploit for SMB, here’s what you can do in msfconsole:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1"></a><span class="ex">msf</span> <span class="op">&gt;</span> use exploit/windows/smb/[tab x 2]</span></code></pre></div>
<p>When you hit the tab key twice, msfconsole will list all the smb exploits for me. And then you can tab-complete your way to pick an exploit.</p>
<p>Another way to search an exploit is with the <code>search</code> command. You can search using the following keywords:</p>
<table>
<thead>
<tr class="header">
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>app</td>
<td>Modules that are client or server attacks</td>
</tr>
<tr class="even">
<td>author</td>
<td>Modules written by this author</td>
</tr>
<tr class="odd">
<td>bid</td>
<td>Modules with a matching Bugtraq ID</td>
</tr>
<tr class="even">
<td>cve</td>
<td>Modules with a matching CVE ID</td>
</tr>
<tr class="odd">
<td>edb</td>
<td>Modules with a matching Exploit-DB ID</td>
</tr>
<tr class="even">
<td>name</td>
<td>Modules with a matching descriptive name</td>
</tr>
<tr class="odd">
<td>osvdb</td>
<td>Modules with a matching OSVDB ID</td>
</tr>
<tr class="even">
<td>platform</td>
<td>Modules affecting this platform</td>
</tr>
<tr class="odd">
<td>ref</td>
<td>Modules with a matching ref</td>
</tr>
<tr class="even">
<td>type</td>
<td>Modules of a specific type (exploit, auxiliary, or post)</td>
</tr>
</tbody>
</table>
<p>An example of using the search command to achieve similar results as using the <code>use</code> command to find exploits:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1"></a><span class="ex">msf</span> <span class="op">&gt;</span> search type:exploit platform:win smb</span></code></pre></div>
<h2 id="choosing-an-exploit">Choosing an exploit</h2>
<p>The harsh reality about exploits is that once they’re publicly known, the effectiveness will eventually expire, and there is no guarantee if there will ever be a replacement for it. Not to mention exploits are typically build-specific. If you want to know what the most current and reliable exploits are, you pretty much have to force yourself to keep up with the news at all times. In reality, most people don’t have this kind of energy, so we vaguely rely on the following guidelines:</p>
<ul>
<li>Pick the latest: You can find out what the latest is by looking at each module’s disclosure date, or CVE number (if there’s one). The newer the date, the less likely the target machine is patched.</li>
<li>Pick the highest-ranking first: Start with Excellent, because those exploits are safer to use. If there isn’t any, try Great, and then Good. Normal is kind of the minimum quality requirement, although occasionally there are exceptions.</li>
<li>Less exploitable requirements: Simply because the more requirements, the harder it is being able to use the exploit.</li>
</ul>
<p>As a quick reference, here are some of your first go-to exploits that are not so application-specific:</p>
<ul>
<li><strong>Remote</strong>
<ul>
<li>exploit/windows/smb/psexec</li>
<li>exploit/windows/smb/psexec_psh</li>
<li>exploit/windows/smb/ms08_067_netapi</li>
<li>exploit/windows/smb/ms17_010_eternalblue</li>
</ul></li>
<li><strong>Client side</strong>
<ul>
<li>exploit/windows/browser/ms13_037_svg_dashstyle (set target to 1)</li>
<li>exploit/windows/browser/ms14_064_ole_code_execution (no patch for XP, no powershell prompt for Win 7 SP0 with IE9, but above that there will be)</li>
<li>exploit/multi/browser/firefox_xpi_bootstrapped_addon</li>
<li>exploit/multi/browser/java_signed_applet</li>
</ul></li>
<li><strong>Local privilege escalation</strong>
<ul>
<li>exploit/windows/local/ms14_058_track_popup_menu</li>
<li>auxiliary/admin/kerberos/ms14_068_kerberos_checksum + standalone mimikatz + exploit/windows/local/current_user_psexec (you can see how this is done in PR <a href="https://github.com/rapid7/metasploit-framework/pull/4456">#4456</a>)</li>
<li>exploit/windows/local/bypassuac_injection + getsystem (meterpreter command)</li>
<li>exploit/windows/local/bypassuac</li>
</ul></li>
</ul>

</div> <!-- article-content -->

<div id="footer-nav-bar">
<div><a href=".././Modules/module-reference-identifiers.html">←prev</a></div><div class="nav-bar-push"><a href="Information-About-Unmet-Browser-Exploit-Requirements.html">next→</a></div>
</div>

</div> <!-- article-box -->

</div> <!-- trunk-box -->

<div id="my-footer">
<p>Copyright <a href="https://metasploit.com/">Metasploit</a>, 2020</p>
<p><a href="https://join.slack.com/t/metasploit/shared_invite/enQtOTMxMjg5ODY3NDYxLTYyZTVlNDM1ZTI3ZGQ0YTQ0NmI1YjgxMGEwYzFhOWNiZWQ4NDNmNTE1MWNiYzJhMzgwMGY0ZWY2NTY0MjA2M2I">Slack team - metasploit.slack.com</a></p>
<p><a href="https://twitter.com/metasploit">#twitter handle - @metasploit</a></p>
<p><a href="mailto:msfdev@metasploit.com">development questions - msfdev [ @ ] metasploit.com</a></p>
<p> This site is built with <a href="http://www.unexpected-vortices.com/sw/rippledoc/index.html">Rippledoc</a>, <a href="https://lunrjs.com/">Lunr</a>, and <a href="https://github.com/BLE-LTER/Lunr-Index-and-Search-for-Static-Sites">BLE-LTER</a>.<br/>
<a href="use-exploits.md">Pandoc-Markdown source for this page</a><br/>
(Docs processed by
<a href="http://www.unexpected-vortices.com/sw/rippledoc/index.html">Rippledoc</a>.)
</div> <!-- my-footer -->

</div> <!-- main-outer-box -->

</body>
</html>
