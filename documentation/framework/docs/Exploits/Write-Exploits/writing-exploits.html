<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Metasploit Version 5" />
  <title>Get Started Writing an Exploit</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../../styles.css" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,400;0,700;1,300;1,400&display=swap" />
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>

<div id="main-outer-box">

<nav class="right">
  <ul>
    <li style="display: inline;"> <a href="https://github.com/rapid7/metasploit-framework/tree/master/documentation/modules" target="_blank">Module Docs</a></li>
    <li style="display: inline;"><a href="https://rapid7.github.io/metasploit-framework/api/" target="_blank">API</a></li>
    <li style="display: inline;"><a href="https://github.com/rapid7/metasploit-framework" target="_blank">Metasploit GitHub</a></li>
     <li style="display: inline;"><a href="../../search.html">Search</a></li>
  </ul>
</nav>

<div id="my-header">
  <a href="{{path-to-index}}">Metasploit Framework</a>
</div>

<div id="trunk-box">

<div id="nav-box">
<p>Contents:</p>
<ul>
<li>Getting-Started/
<ul>
<li><a href="../.././Getting-Started/Installing-Metasploit.html">Installing Metasploit</a></li>
<li><a href="../.././Getting-Started/setting-up-metasploit-dev-enviroment.html">Setting up a Metasploit Developer Environment</a></li>
<li>Contributing/
<ul>
<li><a href="../.././Getting-Started/Contributing/Code-Of-Conduct.html">Contributor Code of Conduct</a></li>
<li><a href="../.././Getting-Started/Contributing/Contributing-to-Metasploit.html">Contributing to Metasploit</a></li>
<li><a href="../.././Getting-Started/Contributing/Guidelines-for-Accepting-Modules-and-Enhancements.html">Guidelines for accepting modules and enhancements</a></li>
<li><a href="../.././Getting-Started/Contributing/Adding-Release-Notes-to-PRs.html">Adding release notes to PRs</a></li>
<li><a href="../.././Getting-Started/Contributing/Landing-Pull-Requests.html">Landing pull requests</a></li>
<li><a href="../.././Getting-Started/Contributing/Keeping-in-sync-with-rapid7-master.html">Keep in sync with master</a></li>
<li><a href="../.././Getting-Started/Contributing/How-to-add-and-update-gems-in-metasploit-framework.html">How to add and update gems</a></li>
<li><a href="../.././Getting-Started/Contributing/How-to-deprecate-a-Metasploit-module.html">How to deprecate a Metasploit module</a></li>
<li><a href="../.././Getting-Started/Contributing/Rolling-back-merges.html">Roll back merges</a></li>
<li><a href="../.././Getting-Started/Contributing/Style-Tips.html">Style Tips</a></li>
<li><a href="../.././Getting-Started/Contributing/Reporting-a-Bug.html">Metasploit Bug Reporting</a></li>
<li><a href="../.././Getting-Started/Contributing/markdown-cheat-sheet.html">Markdown Cheat Sheet</a></li>
</ul></li>
<li>Kali-Linux/
<ul>
<li><a href="../.././Getting-Started/Kali-Linux/How-to-get-Oracle-Support-working-with-Kali-Linux.html">Use Oracle support with Kali Linux</a></li>
</ul></li>
<li><a href="../.././Getting-Started/Contact.html">Contact</a></li>
</ul></li>
<li>Internals/
<ul>
<li><a href="../.././Internals/workspaces.html">Workspaces</a></li>
</ul></li>
<li>Modules/
<ul>
<li><a href="../.././Modules/How-to-use-a-Metasploit-module-appropriately.html">Properly use a module</a></li>
<li><a href="../.././Modules/Module-Documentation.html">Module documentation</a></li>
<li><a href="../.././Modules/Handling-Module-Failures-with-fail_with.html">Handing modules failures with <code>fail_with</code></a></li>
<li><a href="../.././Modules/Running-Private-Modules.html">Run private modules</a></li>
<li><a href="../.././Modules/How-to-do-reporting-or-store-data-in-module-development.html">How to do reporting and store data during module development</a></li>
<li><a href="../.././Modules/Using-ReflectiveDll-Injection.html">Using the ReflectiveDll loader in a Metasploit module</a></li>
<li>Write-Modules/
<ul>
<li><a href="../.././Modules/Write-Modules/How-to-write-a-module-using-HttpServer-and-HttpClient.html">How to write a module using HTTPServer and HTTPClient</a></li>
<li><a href="../.././Modules/Write-Modules/Writing-External-Metasploit-Modules.html">Writing External Metasploit Modules</a></li>
<li><a href="../.././Modules/Write-Modules/get-started-writing-auxillary-module.html">Get started with writing an auxiliary module</a></li>
<li><a href="../.././Modules/Write-Modules/How-to-write-a-HTTP-LoginScanner-Module.html">How to write a HTTP LoginScanner Module</a></li>
<li><a href="../.././Modules/Write-Modules/Writing-External-Python-Modules.html">Writing Python Modules for Metasploit</a></li>
<li><a href="../.././Modules/Write-Modules/get-started-writing-post-module.html">Get started with writing a post module</a></li>
<li><a href="../.././Modules/Write-Modules/Writing-External-GoLang-Modules.html">Writing external GoLang modules</a></li>
<li><a href="../.././Modules/Write-Modules/login-scanner.html">Create a Login Scanner Module</a></li>
<li><a href="../.././Modules/Write-Modules/http-login-scanner.html">How to write a HTTP LoginScanner Module</a></li>
</ul></li>
<li><a href="../.././Modules/module-reference-identifiers.html">Reference Identifiers</a></li>
</ul></li>
<li>Exploits/
<ul>
<li><a href="../.././Exploits/use-exploits.html">Use exploits</a></li>
<li><a href="../.././Exploits/Information-About-Unmet-Browser-Exploit-Requirements.html">Unmet browser exploit requirements</a></li>
<li><a href="../.././Exploits/How-to-use-Powershell-in-an-exploit.html">Add PowerShell mixin to an exploit</a></li>
<li><a href="../.././Exploits/How-to-clean-up-files-using-FileDropper.html">How to clean up files using FileDropper</a></li>
<li><a href="../.././Exploits/How-to-use-PhpEXE-to-exploit-an-arbitrary-file-upload-bug.html">PhpEXE arbitrary file upload</a></li>
<li><a href="../.././Exploits/How-to-use-Railgun-for-Windows-post-exploitation.html">Use Railgun for Windows</a></li>
<li><a href="../.././Exploits/How-to-use-command-stagers.html">Use command stagers</a></li>
<li><a href="../.././Exploits/exploit-ranking.html">Exploit Ranking</a></li>
<li>Write-Exploits/
<ul>
<li><strong>Get Started Writing an Exploit</strong></li>
<li><a href="How-to-use-WbemExec-for-a-write-privilege-attack-on-Windows.html">Write a privilege attack with WbemExec</a></li>
<li><a href="How-to-Use-the-FILEFORMAT-mixin-to-create-a-file-format-exploit.html">How to use the FILEFORMAT mixin</a></li>
<li><a href="How-to-write-a-browser-exploit-using-HttpServer.html">How to write a browser exploit using HTTP Server</a></li>
<li><a href="How-to-write-a-browser-exploit-using-BrowserExploitServer.html">Write a browser exploit with BrowserExploitServer</a></li>
</ul></li>
</ul></li>
<li>Payloads/
<ul>
<li><a href="../.././Payloads/how-payloads-work.html">How Payloads Work</a></li>
<li><a href="../.././Payloads/payload-debugging.html">Payload Debugging</a></li>
<li><a href="../.././Payloads/Payload-UUID.html">Payload UUID</a></li>
<li>Meterpreter/
<ul>
<li><a href="../.././Payloads/Meterpreter/about-meterpreter.html">About Meterpreter</a></li>
<li><a href="../.././Payloads/Meterpreter/meterpreter-configuration.html">Meterpreter Configuration</a></li>
<li><a href="../.././Payloads/Meterpreter/transport-control.html">Transport Control</a></li>
<li><a href="../.././Payloads/Meterpreter/Meterpreter-Reliable-Network-Communication.html">Reliable Network Communication</a></li>
<li><a href="../.././Payloads/Meterpreter/Meterpreter-Unicode-Support.html">Unicode Support</a></li>
<li><a href="../.././Payloads/Meterpreter/Meterpreter-HTTP-Communication.html">Meterpreter HTTP communication</a></li>
<li><a href="../.././Payloads/Meterpreter/Meterpreter-Sleep-Control.html">Sleep Control</a></li>
<li><a href="../.././Payloads/Meterpreter/Meterpreter-Paranoid-Mode.html">Paranoid Mode</a></li>
<li><a href="../.././Payloads/Meterpreter/The-ins-and-outs-of-HTTP-and-HTTPS-communications-in-Meterpreter-and-Metasploit-Stagers.html">HTTP and HTTPS communication</a></li>
<li><a href="../.././Payloads/Meterpreter/Python-Extension.html">Python Extension</a></li>
</ul></li>
<li>msfvenom/
<ul>
<li><a href="../.././Payloads/msfvenom/How-to-use-msfvenom.html">How to use msfvenom</a></li>
</ul></li>
<li>Shell/
<ul>
<li><a href="../.././Payloads/Shell/How-to-use-a-reverse-shell-in-Metasploit.html">How to use a reverse shell</a></li>
</ul></li>
</ul></li>
<li>Utilities/
<ul>
<li><a href="../.././Utilities/complier-windows-c.html">How to use Metasploit Framework Compiler Windows to compile C code</a></li>
<li><a href="../.././Utilities/oracle-support-kali-linux.html">Oracle Support working with Kali Linux</a></li>
<li><a href="../.././Utilities/How-to-zip-files-with-Msf-Util-EXE.to_zip.html">How to zip files with Msf::Util::EXE.to_zip</a></li>
<li><a href="../.././Utilities/How-to-use-the-Msf-Exploit-Remote-Tcp-mixin.html">How to use the Msf::Exploit::Remote::Tcp mixin</a></li>
</ul></li>
<li>Evasion-and-Obfuscation/
<ul>
<li><a href="../.././Evasion-and-Obfuscation/obfuscation-crandomizer.html">CRandomizer</a></li>
<li><a href="../.././Evasion-and-Obfuscation/How-to-obfuscate-JavaScript-in-Metasploit.html">Obfuscate JavaScript</a></li>
<li><a href="../.././Evasion-and-Obfuscation/How-to-use-Metasploit-Framework-Obfuscation-CRandomizer.html">How to use CRandomizer</a></li>
</ul></li>
<li>API/
<ul>
<li><a href="../.././API/Metasploit-Web-Service.html">Metasploit web service</a></li>
<li><a href="../.././API/Metasploit-as-a-service.html">Metasploit as a service</a></li>
</ul></li>
<li>Debugging/
<ul>
<li><a href="../.././Debugging/How-to-log-in-Metasploit.html">Log Files in Metasploit</a></li>
<li><a href="../.././Debugging/Why-CVE-is-not-available.html">Why is a CVE Not Available?</a></li>
</ul></li>
<li><a href="../.././external-resources.html">Community Resources</a></li>
</ul>

</div>

<div id="article-box">

<div id="header-nav-bar">
<div><a href="../.././Exploits/exploit-ranking.html">←prev</a></div><div class="nav-bar-push"><a href="How-to-use-WbemExec-for-a-write-privilege-attack-on-Windows.html">next→</a></div>
</div>

<div id="article-content">
<header id="title-block-header">
<h1 class="title">Get Started Writing an Exploit</h1>
<p class="author">Metasploit Version 5</p>
</header>
<nav id="TOC" role="doc-toc">
<ul>
<li><a href="#plan-your-module">Plan your module</a></li>
<li><a href="#ranking">Ranking</a></li>
<li><a href="#template">Template</a></li>
<li><a href="#basic-git-commands">Basic git commands</a></li>
<li><a href="#references">References</a></li>
</ul>
</nav>
<p>The real kung-fu behind exploit development isn’t actually about which language you choose to build it; it’s about your precise understanding of how input is processed by the application you’re debugging, and how to gain control by manipulating it. That’s right; the keyword is “debugging.” Your binjitsu (reverse-engineering) is where the real kung-fu is. However, if your goal isn’t just about popping a calculator, but actually want to weaponize, to maintain, and to provide use in the practical world, you need a development framework. And this is where Metasploit comes in. It’s a framework that’s free and open-source, actively contributed by researchers around the world. So when you write a Metasploit exploit, you don’t have to worry about any <a href="http://en.wikipedia.org/wiki/Dependency_hell">dependency issues</a>, or having the wrong version, or not having enough payloads for different pentesting scenarios to choose from, etc. The idea is all you need to do is focus on building that exploit, and nothing more.</p>
<h2 id="plan-your-module">Plan your module</h2>
<p>Unlike writing a proof-of-concept, when you write a Metasploit module, you need to think about how users might use it in the real world. Stealth is usually an important element to think about. Can your exploit achieve code execution without dropping a file? Can the input look more random, so it’s more difficult to detect? How about obfuscation? Is it generating unnecessary traffic? Can it be more stable without crashing the system?</p>
<p>Try to be precise about exploitable requirements. Usually, a bug is specific to a range of versions or even builds. If you can’t automatically check that, you need to at least mention it in the description somewhere.</p>
<p>Some of your exploit’s techniques might also be application-specific. For example, you can take advantage of a specific behavior in the application to generate heap allocations the way you want, but maybe it’s noisier in the newer version, so that gives you some stability issues. Does it need a 3rd-party component to work that may not even be installed by everyone? Even if it is, is the component revised often enough that it could make your exploit less reliable?</p>
<p>Know that in the real world, your exploit can break or fail in a lot of different ways. You should try to find out and fix it during the development and testing phase before learning the hard way.</p>
<h2 id="ranking">Ranking</h2>
<p>As you can see, reliability is important to Metasploit, and we try to be more friendly about this for the users. I know what you’re thinking: “Well, if they’re using the exploit, they should understand how it works, so they know what they’re getting themselves into.” In the perfect world, yes. Knowing how a vulnerability works or how an exploit works will only benefit the user, but you see, we don’t live in the perfect world. If you’re in the middle of a penetration test, it’s very unlikely to always find the time to recreate the vulnerable environment, strip the exploit to the most basic form to debug what’s going on, and then do testing. Chances are you have a tight schedule to break into a large network, so you need to use your time carefully. Because of this, it’s important to at least have a good description and good references for the module. And of course, a ranking system that can be trusted.</p>
<p>The Metasploit Framework has seven different rankings to indicate how reliable an exploit is. See [[Exploit Ranking]] for more details.</p>
<h2 id="template">Template</h2>
<p>If you have read this far, we think you are pretty impressive because it’s a lot to digest. You are probably wondering why we haven’t had a single line of code to share in the writeup. Well, as you recall, exploit development is mostly about your reversing skills. If you have all that, we shouldn’t be telling you how to write an exploit. What we’ve done so far is hopefully get your mindset dialed-in correctly about what it means to become a Metasploit exploit developer for the security community; the rest is more about how to use our mixins to build that exploit. Well, there are A LOT of mixins, so it’s impossible to go over all of them in a single page, so you must either read the <a href="https://rapid7.github.io/metasploit-framework/api/">API documentation</a>, existing <a href="https://github.com/rapid7/metasploit-framework/tree/master/modules/exploits">code examples</a>, or look for more wiki pages we’ve written to cover specific mixins.</p>
<p>For example, if you’re looking for a writeup about how to interact with an HTTP server, you might be interested in: <a href="https://github.com/rapid7/metasploit-framework/wiki/How-to-Send-an-HTTP-Request-Using-HTTPClient">How to send an HTTP Request Using HTTPClient</a>. If you’re interested in browser exploit writing, definitely check out: <a href="https://github.com/rapid7/metasploit-framework/wiki/How-to-write-a-browser-exploit-using-BrowserExploitServer">How to write a browser exploit using BrowserExploitServer</a>, etc.</p>
<p>But of course, to begin, you most likely need a template to work with, and here it is. We’ll also explain how to fill out the required fields:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode ruby"><code class="sourceCode ruby"><span id="cb1-1"><a href="#cb1-1"></a><span class="co">##</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="co"># This module requires Metasploit: http://metasploit.com/download</span></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="co"># Current source: https://github.com/rapid7/metasploit-framework</span></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co">##</span></span>
<span id="cb1-5"><a href="#cb1-5"></a></span>
<span id="cb1-6"><a href="#cb1-6"></a>require <span class="st">&#39;msf/core&#39;</span></span>
<span id="cb1-7"><a href="#cb1-7"></a></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="kw">class</span> <span class="dt">MetasploitModule</span> &lt; <span class="dt">Msf</span>::<span class="dt">Exploit</span>::<span class="dt">Remote</span></span>
<span id="cb1-9"><a href="#cb1-9"></a>  <span class="dt">Rank</span> = <span class="dt">NormalRanking</span></span>
<span id="cb1-10"><a href="#cb1-10"></a></span>
<span id="cb1-11"><a href="#cb1-11"></a>  <span class="kw">def</span> initialize(info={})</span>
<span id="cb1-12"><a href="#cb1-12"></a>    <span class="dv">super</span>(update_info(info,</span>
<span id="cb1-13"><a href="#cb1-13"></a>      <span class="st">&#39;Name&#39;</span>           =&gt; <span class="st">&quot;[Vendor] [Software] [Root Cause] [Vulnerability type]&quot;</span>,</span>
<span id="cb1-14"><a href="#cb1-14"></a>      <span class="st">&#39;Description&#39;</span>    =&gt;<span class="ot"> %q{</span></span>
<span id="cb1-15"><a href="#cb1-15"></a><span class="st">        Say something that the user might need to know</span></span>
<span id="cb1-16"><a href="#cb1-16"></a><span class="st">      </span><span class="ot">}</span>,</span>
<span id="cb1-17"><a href="#cb1-17"></a>      <span class="st">&#39;License&#39;</span>        =&gt; <span class="dt">MSF_LICENSE</span>,</span>
<span id="cb1-18"><a href="#cb1-18"></a>      <span class="st">&#39;Author&#39;</span>         =&gt; [ <span class="st">&#39;Name&#39;</span> ],</span>
<span id="cb1-19"><a href="#cb1-19"></a>      <span class="st">&#39;References&#39;</span>     =&gt;</span>
<span id="cb1-20"><a href="#cb1-20"></a>        [</span>
<span id="cb1-21"><a href="#cb1-21"></a>          [ <span class="st">&#39;URL&#39;</span>, <span class="st">&#39;&#39;</span> ]</span>
<span id="cb1-22"><a href="#cb1-22"></a>        ],</span>
<span id="cb1-23"><a href="#cb1-23"></a>      <span class="st">&#39;Platform&#39;</span>       =&gt; <span class="st">&#39;win&#39;</span>,</span>
<span id="cb1-24"><a href="#cb1-24"></a>      <span class="st">&#39;Targets&#39;</span>        =&gt;</span>
<span id="cb1-25"><a href="#cb1-25"></a>        [</span>
<span id="cb1-26"><a href="#cb1-26"></a>          [ <span class="st">&#39;System or software version&#39;</span>,</span>
<span id="cb1-27"><a href="#cb1-27"></a>            {</span>
<span id="cb1-28"><a href="#cb1-28"></a>              <span class="st">&#39;Ret&#39;</span> =&gt; <span class="bn">0x41414141</span> <span class="co"># This will be available in `target.ret`</span></span>
<span id="cb1-29"><a href="#cb1-29"></a>            }</span>
<span id="cb1-30"><a href="#cb1-30"></a>          ]</span>
<span id="cb1-31"><a href="#cb1-31"></a>        ],</span>
<span id="cb1-32"><a href="#cb1-32"></a>      <span class="st">&#39;Payload&#39;</span>        =&gt;</span>
<span id="cb1-33"><a href="#cb1-33"></a>        {</span>
<span id="cb1-34"><a href="#cb1-34"></a>          <span class="st">&#39;BadChars&#39;</span> =&gt; <span class="st">&quot;\x00&quot;</span></span>
<span id="cb1-35"><a href="#cb1-35"></a>        },</span>
<span id="cb1-36"><a href="#cb1-36"></a>      <span class="st">&#39;Privileged&#39;</span>     =&gt; <span class="dv">false</span>,</span>
<span id="cb1-37"><a href="#cb1-37"></a>      <span class="st">&#39;DisclosureDate&#39;</span> =&gt; <span class="st">&quot;&quot;</span>,</span>
<span id="cb1-38"><a href="#cb1-38"></a>      <span class="st">&#39;DefaultTarget&#39;</span>  =&gt; <span class="dv">0</span>))</span>
<span id="cb1-39"><a href="#cb1-39"></a>  <span class="kw">end</span></span>
<span id="cb1-40"><a href="#cb1-40"></a></span>
<span id="cb1-41"><a href="#cb1-41"></a>  <span class="kw">def</span> check</span>
<span id="cb1-42"><a href="#cb1-42"></a>    <span class="co"># For the check command</span></span>
<span id="cb1-43"><a href="#cb1-43"></a>  <span class="kw">end</span></span>
<span id="cb1-44"><a href="#cb1-44"></a></span>
<span id="cb1-45"><a href="#cb1-45"></a>  <span class="kw">def</span> exploit</span>
<span id="cb1-46"><a href="#cb1-46"></a>    <span class="co"># Main function</span></span>
<span id="cb1-47"><a href="#cb1-47"></a>  <span class="kw">end</span></span>
<span id="cb1-48"><a href="#cb1-48"></a></span>
<span id="cb1-49"><a href="#cb1-49"></a><span class="kw">end</span></span></code></pre></div>
<ul>
<li><p><strong>Name</strong> - The Name field should begin with the name of the vendor, followed by the software. Ideally, the “Root Cause” field means which component or function the bug is found. And finally, the type of vulnerability the module is exploiting.</p></li>
<li><p><strong>Description</strong> - The Description field should explain what the module does, things to watch out for, specific requirements, the more, the better. The goal is to let the user understand what he’s using without the need to actually read the module’s source and figure things out. And trust me, most of them don’t.</p></li>
<li><p><strong>Author</strong> field is where you put your name. The format should be “Name”. If you want to have your Twitter handle there, leave it as a comment, for example: “Name # handle”</p></li>
<li><p><strong>References</strong> - The References field is an array of <a href="https://github.com/rapid7/metasploit-framework/blob/master/lib/msf/core/module/reference.rb">references</a> related to the vulnerability or the exploit. For example, an advisory, a blog post, etc. Make sure you use known reference identifiers – see [[Metasploit module reference identifiers]] for a list.</p></li>
<li><p><strong>Platform</strong> - The Platform field indicates what platforms are supported, for example: win, linux, osx, unix, bsd.</p></li>
<li><p><strong>Targets</strong> - The Targets field is an array of systems, applications, setups, or specific versions your exploit is targeting. The second element or each target array is where you store specific metadata about that target, for example, a specific offset, a gadget, a ret address, etc. When a target is selected by the user, the metadata is loaded and tracked by a “target index”, and can be retrieved by using the <code>target</code> method.</p></li>
<li><p><strong>Payloads</strong> - The Payloads field specifies how the payload should be encoded and generated. You can specify: <code>Space</code>, <code>SaveRegisters</code>, <code>Prepend</code>, <code>PrependEncoder</code>, <code>BadChars</code>, <code>Append</code>, <code>AppendEncoder</code>, <code>MaxNops</code>, <code>MinNops</code>, <code>Encoder</code>, <code>Nop</code>, <code>EncoderType</code>, <code>EncoderOptions</code>, <code>ExtendedOptions</code>, <code>EncoderDontFallThrough</code>.</p></li>
</ul>
<p><strong>DisclosureDate</strong> - The DisclosureDate is about when the vulnerability was disclosed in public, in the format of: “M D Y”. For example: “Apr 04 2014”</p>
<p>Your exploit should also have a <code>check</code> method to support the check command, but this is optional in case it’s not possible.</p>
<p>And finally, the <code>exploit</code> method is like your main method. Start writing your code there.</p>
<p>An example exploit module is also available: <a href="https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/example.rb">example.rb</a></p>
<h2 id="basic-git-commands">Basic git commands</h2>
<p>Metasploit no longer uses svn for source code management. Instead, we use git, so knowing some tricks with git go a long way. We’re not here to lecture you about how awesome git is; we know it has a learning curve, and it’s not surprising to find new users making mistakes. Every once a while, your git “rage” will kick in, and we understand. However, it’s important for you to take advantage of branching.</p>
<p>Every time you make a module or make some changes to existing code, you should not do so on the default master branch. Why? Because when you do a <code>msfupdate</code>, which is Metasploit’s utility for updating your repository, it will do a git reset before merging the changes, and all your code goes away.</p>
<p>Another mistake people tend to do is have all the changes on master before submitting a pull request. This is a bad idea because most likely; you’re submitting other crap you don’t intend to change, or you’re probably asking us to merge other unnecessary commit histories when there only needs to be one commit. Thanks for contributing your module to the community, but no thanks to your crazy commit history.</p>
<p>So as a habit, when you want to make something new, or change something, begin with a new branch that’s up to date to master. First off, make sure you’re on master. If you do a <code>git status</code> it will tell you what branch you’re currently on:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1"></a>$ <span class="fu">git</span> status</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="co"># On branch upstream-master</span></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="ex">nothing</span> to commit, working directory clean</span></code></pre></div>
<p>Ok, now do a <code>git pull</code> to download the latest changes from Metasploit:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1"></a>$ <span class="fu">git</span> pull</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="ex">Already</span> up-to-date.</span></code></pre></div>
<p>At this point, you’re ready to start a new branch. In this case, we’ll name our new branch “my_awesome_branch”:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1"></a>$ <span class="fu">git</span> checkout -b my_awesome_branch</span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="ex">Switched</span> to a new branch <span class="st">&#39;my_awesome_branch&#39;</span></span></code></pre></div>
<p>And then you can go ahead and add that module. Make sure it’s in the appropriate path:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1"></a>$ <span class="fu">git</span> add [module path]</span></code></pre></div>
<p>When you decide to save the changes, commit (if there’s only one module, you can do <code>git commit -a</code> too so you don’t have to type the module path. Note <code>-a</code> really means EVERYTHING):</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1"></a>$ <span class="fu">git</span> commit [module path]</span></code></pre></div>
<p>When you’re done, push your changes, which will upload your code to your remote branch “my_awesome_branch”. You must push your changes in order to submit the pull request or share it with others on the Internet.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1"></a>$ <span class="fu">git</span> push origin my_awesome_branch</span></code></pre></div>
<h2 id="references">References</h2>
<p>https://github.com/rapid7/metasploit-framework/blob/master/lib/msf/core/exploit.rb</p>

</div> <!-- article-content -->

<div id="footer-nav-bar">
<div><a href="../.././Exploits/exploit-ranking.html">←prev</a></div><div class="nav-bar-push"><a href="How-to-use-WbemExec-for-a-write-privilege-attack-on-Windows.html">next→</a></div>
</div>

</div> <!-- article-box -->

</div> <!-- trunk-box -->

<div id="my-footer">
<p>Copyright <a href="https://metasploit.com/">Metasploit</a>, 2020</p>
<p><a href="https://join.slack.com/t/metasploit/shared_invite/enQtOTMxMjg5ODY3NDYxLTYyZTVlNDM1ZTI3ZGQ0YTQ0NmI1YjgxMGEwYzFhOWNiZWQ4NDNmNTE1MWNiYzJhMzgwMGY0ZWY2NTY0MjA2M2I">Slack team - metasploit.slack.com</a></p>
<p><a href="https://twitter.com/metasploit">#twitter handle - @metasploit</a></p>
<p><a href="mailto:msfdev@metasploit.com">development questions - msfdev [ @ ] metasploit.com</a></p>
<p> This site is built with <a href="http://www.unexpected-vortices.com/sw/rippledoc/index.html">Rippledoc</a>, <a href="https://lunrjs.com/">Lunr</a>, and <a href="https://github.com/BLE-LTER/Lunr-Index-and-Search-for-Static-Sites">BLE-LTER</a>.<br/>
<a href="writing-exploits.md">Pandoc-Markdown source for this page</a><br/>
(Docs processed by
<a href="http://www.unexpected-vortices.com/sw/rippledoc/index.html">Rippledoc</a>.)
</div> <!-- my-footer -->

</div> <!-- main-outer-box -->

</body>
</html>
